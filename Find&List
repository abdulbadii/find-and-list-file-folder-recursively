#! /usr/bin/bash
l(){
a=;i=;o=;t=;E=;r=%p;
for a
{
let i++
case ${a:0:3} in
	-s) r='%s %p';;
	-t) r='%p %Tr %Tx';;
	-st) r="%s %p %Tr %Tx";;
	-d[0-9]) t="-maxdepth ${a:2}";;
	-E) E=1;;
	-[A-Za-z]*|-[0-9]*) o="$o $a";;
	*)
	a=`history 1`;a=${a##* }
	if [ "${a:0:1}" = / ];then
		p=${a%%[*?]*};	p=${p%/*}/
		a=${a#$p}
		if [ $E ] ;then
			a=${a//\*\*/.*}
			find "$p" $t -regextype posix-extended -iregex "$p$a" $o -printf "$r \n"
		else
			a=${a//./\\.}
			if [[ $a =~ \*\* ]] ;then
				a=${a//\*\*/|/};a=${a//\*/[^\/]*};a=${a//|\//.*}
			else	a=${a//\*/[^\/]*}
			fi
			find "$p" $t -regextype posix-extended -iregex "$p${a//\?/.}" $o -printf "$r \n"
		fi
	elif [ $E ] ;then
			a=${a//\*\*/.*}
			find ~+ $t -regextype posix-extended -iregex ".*/$a" $o -printf "$r \n"
	else
		a=${a//./\\.}
		if [[ $a =~ \*\* ]] ;then
			a=${a//\*\*/|/};	a=${a//\*/[^\/]*};	a=${a//|\//.*};
		else	a=${a//\*/[^\/]*}
		fi
		find ~+ $t -regextype posix-extended -iregex ".*/${a//\?/.}" $o -printf "$r \n"
	fi
	return;;
esac
}
[ ! $a ]&&find ~+ -regextype posix-extended -regex '.*'
}
